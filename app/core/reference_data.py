# -*- coding: utf-8 -*-
"""
Datos de referencia oficiales del Ministerio de Hacienda de Costa Rica v4.4
Fuente: Referencias/Codificacionubicacion_V4.4.xlsx y Referencias/Codigodemoneda_V4.4.pdf
"""

# Códigos oficiales de ubicación de Costa Rica
UBICACIONES_CR = {
    "01": {
        "nombre": "SAN JOSÉ",
        "cantones": {
            "01": {
                "nombre": "SAN JOSÉ",
                "distritos": {
                    "01": "CARMEN",
                    "02": "MERCED",
                    "03": "HOSPITAL",
                    "04": "CATEDRAL",
                    "05": "ZAPOTE",
                    "06": "SAN FRANCISCO DE DOS RÍOS",
                    "07": "URUCA",
                    "08": "MATA REDONDA",
                    "09": "PAVAS",
                    "10": "HATILLO",
                    "11": "SAN SEBASTIÁN"
                }
            },
            "02": {
                "nombre": "ESCAZÚ",
                "distritos": {
                    "01": "ESCAZÚ",
                    "02": "SAN ANTONIO",
                    "03": "SAN RAFAEL"
                }
            },
            "03": {
                "nombre": "DESAMPARADOS",
                "distritos": {
                    "01": "DESAMPARADOS",
                    "02": "SAN MIGUEL",
                    "03": "SAN JUAN DE DIOS",
                    "04": "SAN RAFAEL ARRIBA",
                    "05": "SAN ANTONIO",
                    "06": "FRAILES",
                    "07": "PATARRÁ",
                    "08": "SAN CRISTÓBAL",
                    "09": "ROSARIO",
                    "10": "DAMAS",
                    "11": "SAN RAFAEL ABAJO",
                    "12": "GRAVILIAS",
                    "13": "LOS GUIDO"
                }
            },
            "04": {
                "nombre": "PURISCAL",
                "distritos": {
                    "01": "SANTIAGO",
                    "02": "MERCEDES SUR",
                    "03": "BARBACOAS",
                    "04": "GRIFO ALTO",
                    "05": "SAN RAFAEL",
                    "06": "CANDELARITA",
                    "07": "DESAMPARADITOS",
                    "08": "SAN ANTONIO",
                    "09": "CHIRES"
                }
            },
            "05": {
                "nombre": "TARRAZÚ",
                "distritos": {
                    "01": "SAN MARCOS",
                    "02": "SAN LORENZO",
                    "03": "SAN CARLOS"
                }
            }
        }
    },
    "02": {
        "nombre": "ALAJUELA",
        "cantones": {
            "01": {
                "nombre": "ALAJUELA",
                "distritos": {
                    "01": "ALAJUELA",
                    "02": "SAN JOSÉ",
                    "03": "CARRIZAL",
                    "04": "SAN ANTONIO",
                    "05": "GUÁCIMA",
                    "06": "SAN ISIDRO",
                    "07": "SABANILLA",
                    "08": "SAN RAFAEL",
                    "09": "RÍO SEGUNDO",
                    "10": "DESAMPARADOS",
                    "11": "TURRÚCARES",
                    "12": "TAMBOR",
                    "13": "GARITA",
                    "14": "SARAPIQUÍ"
                }
            },
            "02": {
                "nombre": "SAN RAMÓN",
                "distritos": {
                    "01": "SAN RAMÓN",
                    "02": "SANTIAGO",
                    "03": "SAN JUAN",
                    "04": "PIEDADES NORTE",
                    "05": "PIEDADES SUR",
                    "06": "SAN RAFAEL",
                    "07": "SAN ISIDRO",
                    "08": "ÁNGELES",
                    "09": "ALFARO",
                    "10": "VOLIO",
                    "11": "CONCEPCIÓN",
                    "12": "ZAPOTAL",
                    "13": "PEÑAS BLANCAS"
                }
            }
        }
    },
    "03": {
        "nombre": "CARTAGO",
        "cantones": {
            "01": {
                "nombre": "CARTAGO",
                "distritos": {
                    "01": "ORIENTAL",
                    "02": "OCCIDENTAL",
                    "03": "CARMEN",
                    "04": "SAN NICOLÁS",
                    "05": "AGUACALIENTE O SAN FRANCISCO",
                    "06": "GUADALUPE O ARENILLA",
                    "07": "CORRALILLO",
                    "08": "TIERRA BLANCA",
                    "09": "DULCE NOMBRE",
                    "10": "LLANO GRANDE",
                    "11": "QUEBRADILLA"
                }
            },
            "02": {
                "nombre": "PARAÍSO",
                "distritos": {
                    "01": "PARAÍSO",
                    "02": "SANTIAGO",
                    "03": "OROSI",
                    "04": "CACHÍ",
                    "05": "LLANOS DE SANTA LUCÍA"
                }
            }
        }
    },
    "04": {
        "nombre": "HEREDIA",
        "cantones": {
            "01": {
                "nombre": "HEREDIA",
                "distritos": {
                    "01": "HEREDIA",
                    "02": "MERCEDES",
                    "03": "SAN FRANCISCO",
                    "04": "ULLOA",
                    "05": "VARABLANCA"
                }
            },
            "02": {
                "nombre": "BARVA",
                "distritos": {
                    "01": "BARVA",
                    "02": "SAN PEDRO",
                    "03": "SAN PABLO",
                    "04": "SAN ROQUE",
                    "05": "SANTA LUCÍA",
                    "06": "SAN JOSÉ DE LA MONTAÑA"
                }
            }
        }
    },
    "05": {
        "nombre": "GUANACASTE",
        "cantones": {
            "01": {
                "nombre": "LIBERIA",
                "distritos": {
                    "01": "LIBERIA",
                    "02": "CAÑAS DULCES",
                    "03": "MAYORGA",
                    "04": "NACASCOLO",
                    "05": "CURUBANDÉ"
                }
            },
            "02": {
                "nombre": "NICOYA",
                "distritos": {
                    "01": "NICOYA",
                    "02": "MANSIÓN",
                    "03": "SAN ANTONIO",
                    "04": "QUEBRADA HONDA",
                    "05": "SÁMARA",
                    "06": "NOSARA",
                    "07": "BELÉN DE NOSARITA"
                }
            }
        }
    },
    "06": {
        "nombre": "PUNTARENAS",
        "cantones": {
            "01": {
                "nombre": "PUNTARENAS",
                "distritos": {
                    "01": "PUNTARENAS",
                    "02": "PITAHAYA",
                    "03": "CHOMES",
                    "04": "LEPANTO",
                    "05": "PAQUERA",
                    "06": "MANZANILLO",
                    "07": "GUACIMAL",
                    "08": "BARRANCA",
                    "09": "MONTE VERDE",
                    "10": "ISLA DEL COCO",
                    "11": "CÓBANO",
                    "12": "CHACARITA",
                    "13": "CHIRA",
                    "14": "ACAPULCO",
                    "15": "EL ROBLE",
                    "16": "ARANCIBIA"
                }
            },
            "02": {
                "nombre": "ESPARZA",
                "distritos": {
                    "01": "ESPÍRITU SANTO",
                    "02": "SAN JUAN GRANDE",
                    "03": "MACACONA",
                    "04": "SAN RAFAEL",
                    "05": "SAN JERÓNIMO",
                    "06": "CALDERA"
                }
            }
        }
    },
    "07": {
        "nombre": "LIMÓN",
        "cantones": {
            "01": {
                "nombre": "LIMÓN",
                "distritos": {
                    "01": "LIMÓN",
                    "02": "VALLE LA ESTRELLA",
                    "03": "RÍO BLANCO",
                    "04": "MATAMA"
                }
            },
            "02": {
                "nombre": "POCOCÍ",
                "distritos": {
                    "01": "GUÁPILES",
                    "02": "JIMÉNEZ",
                    "03": "RITA",
                    "04": "ROXANA",
                    "05": "CARIARI",
                    "06": "COLORADO"
                }
            }
        }
    }
}

# Códigos oficiales de moneda según ISO 4217
MONEDAS_OFICIALES = {
    "CRC": "Colón costarricense",
    "USD": "Dólar estadounidense",
    "EUR": "Euro",
    "CAD": "Dólar canadiense",
    "GBP": "Libra esterlina",
    "JPY": "Yen japonés",
    "CHF": "Franco suizo",
    "AUD": "Dólar australiano",
    "NZD": "Dólar neozelandés",
    "SEK": "Corona sueca",
    "NOK": "Corona noruega",
    "DKK": "Corona danesa",
    "PLN": "Zloty polaco",
    "CZK": "Corona checa",
    "HUF": "Forint húngaro",
    "BGN": "Lev búlgaro",
    "RON": "Leu rumano",
    "HRK": "Kuna croata",
    "RSD": "Dinar serbio",
    "BAM": "Marco convertible de Bosnia-Herzegovina",
    "MXN": "Peso mexicano",
    "GTQ": "Quetzal guatemalteco",
    "HNL": "Lempira hondureño",
    "NIO": "Córdoba nicaragüense",
    "PAB": "Balboa panameño",
    "BZD": "Dólar beliceño",
    "XCD": "Dólar del Caribe Oriental",
    "COP": "Peso colombiano",
    "VES": "Bolívar venezolano",
    "BRL": "Real brasileño",
    "ARS": "Peso argentino",
    "CLP": "Peso chileno",
    "PEN": "Sol peruano",
    "UYU": "Peso uruguayo",
    "PYG": "Guaraní paraguayo",
    "BOB": "Boliviano",
    "CNY": "Yuan chino",
    "KRW": "Won surcoreano",
    "INR": "Rupia india",
    "THB": "Baht tailandés",
    "MYR": "Ringgit malayo",
    "SGD": "Dólar singapurense",
    "PHP": "Peso filipino",
    "IDR": "Rupia indonesia",
    "VND": "Dong vietnamita",
    "TRY": "Lira turca",
    "RUB": "Rublo ruso",
    "ZAR": "Rand sudafricano",
    "EGP": "Libra egipcia",
    "NGN": "Naira nigeriana",
    "KES": "Chelín keniano",
    "GHS": "Cedi ghanés",
    "MAD": "Dirham marroquí",
    "TND": "Dinar tunecino",
    "DZD": "Dinar argelino",
    "AOA": "Kwanza angoleño",
    "XAF": "Franco CFA de África Central",
    "XOF": "Franco CFA de África Occidental"
}

# Función helper para validar ubicaciones
def validar_ubicacion(provincia: str, canton: str, distrito: str) -> tuple[bool, str]:
    """
    Validar códigos de ubicación según datos oficiales de Hacienda
    
    Args:
        provincia: Código de provincia (01-07)
        canton: Código de cantón 
        distrito: Código de distrito
        
    Returns:
        tuple: (es_valido, mensaje_error)
    """
    if provincia not in UBICACIONES_CR:
        return False, f"Provincia '{provincia}' no es válida. Debe ser: {', '.join(UBICACIONES_CR.keys())}"
    
    if canton not in UBICACIONES_CR[provincia]["cantones"]:
        cantones_validos = ', '.join(UBICACIONES_CR[provincia]["cantones"].keys())
        return False, f"Cantón '{canton}' no es válido para provincia {provincia}. Debe ser: {cantones_validos}"
    
    if distrito not in UBICACIONES_CR[provincia]["cantones"][canton]["distritos"]:
        distritos_validos = ', '.join(UBICACIONES_CR[provincia]["cantones"][canton]["distritos"].keys())
        return False, f"Distrito '{distrito}' no es válido para cantón {canton}. Debe ser: {distritos_validos}"
    
    return True, ""

# Función helper para validar monedas
def validar_moneda(codigo_moneda: str) -> tuple[bool, str]:
    """
    Validar código de moneda según ISO 4217
    
    Args:
        codigo_moneda: Código de moneda (ej: CRC, USD)
        
    Returns:
        tuple: (es_valido, mensaje_error)
    """
    if codigo_moneda not in MONEDAS_OFICIALES:
        return False, f"Moneda '{codigo_moneda}' no es válida. Debe ser una de: {', '.join(list(MONEDAS_OFICIALES.keys())[:10])}..."
    
    return True, ""

# Función helper para obtener información de ubicación
def obtener_info_ubicacion(provincia: str, canton: str = None, distrito: str = None) -> dict:
    """
    Obtener información detallada de ubicación
    
    Args:
        provincia: Código de provincia
        canton: Código de cantón (opcional)
        distrito: Código de distrito (opcional)
        
    Returns:
        dict: Información de la ubicación
    """
    if provincia not in UBICACIONES_CR:
        return {}
    
    info = {
        "provincia": {
            "codigo": provincia,
            "nombre": UBICACIONES_CR[provincia]["nombre"]
        }
    }
    
    if canton and canton in UBICACIONES_CR[provincia]["cantones"]:
        info["canton"] = {
            "codigo": canton,
            "nombre": UBICACIONES_CR[provincia]["cantones"][canton]["nombre"]
        }
        
        if distrito and distrito in UBICACIONES_CR[provincia]["cantones"][canton]["distritos"]:
            info["distrito"] = {
                "codigo": distrito,
                "nombre": UBICACIONES_CR[provincia]["cantones"][canton]["distritos"][distrito]
            }
    
    return info